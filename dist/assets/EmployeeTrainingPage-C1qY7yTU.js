import{a as E,r as d,j as e,A as h,S as j,n as i}from"./index-Dn7xk2-6.js";import{T}from"./TrainingList-R4u01nom.js";import{u as y,c as x}from"./training-B5HIwrpD.js";function O(){const{token:c,me:s}=E(),t=String((s==null?void 0:s.candidateId)||"").trim(),[g,m]=d.useState(!1),[l,p]=d.useState([]),n=d.useMemo(()=>(Array.isArray(l)?l:[]).reduce((a,u)=>{const f=String((u==null?void 0:u.status)||"").toUpperCase();return a.TOTAL+=1,f==="COMPLETED"?a.COMPLETED+=1:f==="IN_PROGRESS"?a.IN_PROGRESS+=1:f==="OVERDUE"?a.OVERDUE+=1:a.PENDING+=1,a},{TOTAL:0,PENDING:0,IN_PROGRESS:0,COMPLETED:0,OVERDUE:0}),[l]);async function o(){if(!t){p([]);return}m(!0);try{const r=await x(c,{candidateId:t});p(r.items??[])}catch(r){i.error((r==null?void 0:r.message)||"Failed to load trainings"),p([])}finally{m(!1)}}return d.useEffect(()=>{o()},[t]),e.jsx(h,{children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",flexWrap:"wrap"},children:[e.jsx("h2",{style:{margin:0},children:"My Trainings"}),e.jsx("div",{className:"spacer"}),e.jsxs("button",{className:"button",type:"button",onClick:o,disabled:g,children:[g?e.jsx(j,{size:14}):null,"Refresh"]})]}),e.jsx("div",{style:{height:10}}),e.jsxs("div",{className:"small",style:{color:"var(--gray-600)"},children:["Employee: ",e.jsx("b",{children:(s==null?void 0:s.fullName)||(s==null?void 0:s.employeeId)||(s==null?void 0:s.userId)||"-"}),s!=null&&s.jobRole?` • Role: ${s.jobRole}`:"",s!=null&&s.jobTitle?` • ${s.jobTitle}`:""]}),e.jsxs("div",{className:"small",style:{color:"var(--gray-500)",marginTop:4},children:["Employee ID: ",e.jsx("b",{children:(s==null?void 0:s.employeeId)||(s==null?void 0:s.userId)||"-"})]}),e.jsx("div",{style:{height:12}}),n.TOTAL?e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[e.jsxs("span",{className:"badge",children:["Total: ",n.TOTAL]}),e.jsxs("span",{className:"badge",style:{background:"#f59e0b",color:"#fff"},children:["Pending: ",n.PENDING]}),e.jsxs("span",{className:"badge",style:{background:"#3b82f6",color:"#fff"},children:["In-Progress: ",n.IN_PROGRESS]}),e.jsxs("span",{className:"badge",style:{background:"#22c55e",color:"#fff"},children:["Completed: ",n.COMPLETED]}),e.jsxs("span",{className:"badge",style:{background:"#ef4444",color:"#fff"},children:["Overdue: ",n.OVERDUE]})]}):null,e.jsx(T,{items:l,loading:g,canUpdate:!0,onStart:async r=>{try{await y(c,{candidate_id:t,assigned_id:r.assigned_id,op:"START",remarks:""}),i.success("Marked In-Progress"),await o()}catch(a){i.error((a==null?void 0:a.message)||"Failed")}},onComplete:async r=>{try{await y(c,{candidate_id:t,assigned_id:r.assigned_id,op:"COMPLETE",remarks:""}),i.success("Completed"),await o()}catch(a){i.error((a==null?void 0:a.message)||"Failed")}}}),t?null:e.jsx("div",{className:"small",style:{marginTop:10,color:"var(--danger)"},children:"Candidate mapping not found for this Employee ID."})]})})}export{O as EmployeeTrainingPage};
