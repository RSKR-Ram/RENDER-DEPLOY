import{r as a,j as e,S as Te,n as m,u as ss,a as ts,b as as,c as ls,p as rs,t as is,s as ns,l as os,A as ds,d as cs,e as ps,f as ke,g as ne,h as us,i as ms,k as hs}from"./index-DseEmN6k.js";import{t as gs,a as ys}from"./training-CPjnFHYB.js";function xs(d){return!Array.isArray(d)||!d.length?"":d.filter(Boolean).map(i=>String(i)).join(`
`)}function bs({token:d}){const[i,_]=a.useState(!1),[U,c]=a.useState([]),[W,F]=a.useState(!1),[p,v]=a.useState({training_id:"",name:"",department:"",description:"",video_link:"",documentsLines:""});async function E(){_(!0);try{const r=await gs(d);c(r.items??[])}catch(r){m.error((r==null?void 0:r.message)||"Failed to load trainings")}finally{_(!1)}}a.useEffect(()=>{E()},[]);const j=a.useMemo(()=>!!String(p.name||"").trim()&&!!String(p.department||"").trim(),[p]);async function N(r){var x;if((x=r==null?void 0:r.preventDefault)==null||x.call(r),!j){m.error("Name and Department are required");return}F(!0);try{const f={training_id:String(p.training_id||"").trim()||void 0,name:String(p.name||"").trim(),department:String(p.department||"").trim(),description:String(p.description||"").trim(),video_link:String(p.video_link||"").trim(),documentsLines:String(p.documentsLines||"")},L=await ys(d,f);m.success(f.training_id?"Training updated":"Training created"),v({training_id:"",name:"",department:"",description:"",video_link:"",documentsLines:""}),await E(),L!=null&&L.training_id}catch(f){m.error((f==null?void 0:f.message)||"Save failed")}finally{F(!1)}}return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:0},children:"Training Builder (Templates)"}),e.jsx("div",{style:{marginLeft:"auto"},children:e.jsxs("button",{className:"button",type:"button",onClick:E,disabled:i,children:[i?e.jsx(Te,{size:14}):null,"Refresh"]})})]}),e.jsx("div",{style:{height:10}}),e.jsxs("form",{onSubmit:N,className:"card",style:{background:"#fafafa"},children:[e.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Training Name (e.g., CRM)",value:p.name,onChange:r=>v(x=>({...x,name:r.target.value})),style:{minWidth:220}}),e.jsx("input",{placeholder:"Department (e.g., Accounts)",value:p.department,onChange:r=>v(x=>({...x,department:r.target.value})),style:{minWidth:180}}),e.jsx("input",{placeholder:"Video Link",value:p.video_link,onChange:r=>v(x=>({...x,video_link:r.target.value})),style:{minWidth:240}})]}),e.jsx("div",{style:{height:10}}),e.jsxs("div",{children:[e.jsx("label",{className:"small",style:{fontWeight:700,display:"block",marginBottom:4},children:"Description"}),e.jsx("textarea",{value:p.description,onChange:r=>v(x=>({...x,description:r.target.value})),rows:3,style:{width:"100%"}})]}),e.jsx("div",{style:{height:10}}),e.jsxs("div",{children:[e.jsx("label",{className:"small",style:{fontWeight:700,display:"block",marginBottom:4},children:"Documents (one URL per line)"}),e.jsx("textarea",{value:p.documentsLines,onChange:r=>v(x=>({...x,documentsLines:r.target.value})),rows:3,style:{width:"100%"}})]}),e.jsx("div",{style:{height:10}}),e.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap"},children:[e.jsxs("button",{className:"button primary",type:"submit",disabled:W||!j,children:[W?e.jsx(Te,{size:14}):null,p.training_id?"Update Template":"Create Template"]}),e.jsx("button",{className:"button",type:"button",onClick:()=>v({training_id:"",name:"",department:"",description:"",video_link:"",documentsLines:""}),disabled:W,children:"Clear"})]})]}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"small",children:i?"Loading…":`${U.length} templates`}),e.jsx("div",{style:{height:10}}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:10},children:U.map(r=>e.jsxs("div",{className:"card",style:{background:"#fff",border:"1px solid var(--gray-200)"},children:[e.jsxs("div",{className:"row",style:{gap:10,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1,minWidth:220},children:[e.jsx("div",{style:{fontWeight:700},children:r.name}),e.jsx("div",{className:"small",style:{color:"var(--gray-500)",marginTop:2},children:r.department})]}),e.jsx("button",{className:"button",type:"button",onClick:()=>v({training_id:r.training_id,name:r.name||"",department:r.department||"",description:r.description||"",video_link:r.video_link||"",documentsLines:xs(r.documents)}),children:"Edit"})]}),r.video_link?e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"button",type:"button",onClick:()=>window.open(r.video_link,"_blank","noopener,noreferrer"),children:"Open Video"})}):null]},r.training_id))})]})}function h(d,i){m.error(i,{id:d})}function g(d,i){return d instanceof cs?d.message||i:(d==null?void 0:d.message)??i}function Ie(d){if(!d)return"";const i=new Date(d),_=i.getFullYear(),U=String(i.getMonth()+1).padStart(2,"0"),c=String(i.getDate()).padStart(2,"0");return`${_}-${U}-${c}`}function fs(){const d=ss(),{token:i,role:_}=ts(),U=a.useMemo(()=>[{key:"users",label:"Users"},{key:"roles",label:"Roles"},{key:"permissions",label:"Permissions"},{key:"templates",label:"Job Templates"},{key:"trainings",label:"Trainings"},{key:"settings",label:"Settings"},{key:"logs",label:"Logs"}],[]),[c,W]=a.useState("users"),[F,p]=a.useState([]),[v,E]=a.useState(!1),[j,N]=a.useState({email:"",fullName:"",role:"EA",active:!0}),[r,x]=a.useState([]),[f,L]=a.useState(!1),[w,M]=a.useState({roleCode:"",roleName:"",status:"ACTIVE"}),[S,we]=a.useState([]),[H,oe]=a.useState(!1),[J,Re]=a.useState(""),[G,Ae]=a.useState(""),[C,R]=a.useState({permType:"UI",permKey:"",rolesCsv:"",enabled:!0}),[T,_e]=a.useState(""),[D,k]=a.useState(!1),[de,Ue]=a.useState([]),[Ee,ce]=a.useState(!1),[y,b]=a.useState({templateId:null,jobRole:"",jobTitle:"",jd:"",responsibilities:"",skills:"",shift:"",payScale:"",perks:"",notes:"",active:!0}),[Le,pe]=a.useState(!1),[ue,me]=a.useState(!1),[he,ge]=a.useState(6),[ye,xe]=a.useState(3),[be,je]=a.useState(""),[ve,fe]=a.useState(!1),[O,Me]=a.useState("AUDIT"),[K,Pe]=a.useState(Ie(new Date(Date.now()-7*24*60*60*1e3))),[B,We]=a.useState(Ie(new Date)),[q,Fe]=a.useState(""),[X,Oe]=a.useState(""),[Q,De]=a.useState(""),[z,Ke]=a.useState(""),[Y,Be]=a.useState(""),[Z,Ve]=a.useState(""),[Ce,$e]=a.useState([]),ee=a.useCallback(async()=>{E(!0);try{const s=await as(i,{page:1,pageSize:500});p(s.items??[])}catch(s){h("admin_users_load",g(s,"Failed to load users"))}finally{E(!1)}},[i]),A=a.useCallback(async()=>{L(!0);try{const s=await ls(i,{includeInactive:!0});x(s.items??[])}catch(s){h("admin_roles_load",g(s,"Failed to load roles"))}finally{L(!1)}},[i]),I=a.useCallback(async()=>{oe(!0);try{const s=await rs(i);we(s.items??[])}catch(s){h("admin_permissions_load",g(s,"Failed to load permissions"))}finally{oe(!1)}},[i]),se=a.useCallback(async()=>{ce(!0);try{const s=await is(i,{page:1,pageSize:500});Ue(s.items??[])}catch(s){h("admin_templates_load",g(s,"Failed to load templates"))}finally{ce(!1)}},[i]),te=a.useCallback(async()=>{pe(!0);try{const t=(await ns(i)).items??[],l=t.find(o=>o.key==="PASSING_MARKS"),n=t.find(o=>o.key==="NOT_PICK_THRESHOLD"),u=t.find(o=>o.key==="INTERVIEW_MESSAGE_TEMPLATE");l&&ge(Number(l.value??6)),n&&xe(Number(n.value??3)),u&&je(String(u.value??""))}catch(s){h("admin_settings_load",g(s,"Failed to load settings"))}finally{pe(!1)}},[i]),ae=a.useCallback(async()=>{fe(!0);try{const s=await os(i,{logType:O,from:K?new Date(K).toISOString():null,to:B?new Date(B+"T23:59:59").toISOString():null,stageTag:q||null,actorRole:X||null,entityType:Q||null,entityId:z||null,candidateId:Y||null,requirementId:Z||null,page:1,pageSize:200});$e(s.items??[])}catch(s){h("admin_logs_load",g(s,"Failed to load logs"))}finally{fe(!1)}},[i,O,K,B,q,X,Q,z,Y,Z]);a.useEffect(()=>{c==="users"&&ee(),c==="users"&&A(),c==="roles"&&A(),c==="permissions"&&(A(),I()),c==="templates"&&se(),c==="settings"&&te(),c==="logs"&&ae()},[c,ee,A,I,se,te,ae]);const le=a.useMemo(()=>{const l=(Array.isArray(r)?r:[]).filter(n=>String(n.status||"").toUpperCase()==="ACTIVE").map(n=>String(n.roleCode||"").toUpperCase()).filter(Boolean);return l.length?l.sort():["ADMIN","EA","HR","OWNER"]},[r]);a.useMemo(()=>{const s={};for(const t of r||[])s[String(t.roleCode||"").toUpperCase()]=t;return s},[r]);const Ne=a.useMemo(()=>{const s=Array.isArray(S)?S:[],t=String(J||"").toUpperCase().trim(),l=String(G||"").toUpperCase().trim();return s.filter(n=>!(t&&String(n.permType||"").toUpperCase()!==t||l&&!`${n.permType||""}:${n.permKey||""}:${n.rolesCsv||""}`.toUpperCase().includes(l)))},[S,J,G]);function re(s){return String(s||"").split(",").map(t=>t.trim().toUpperCase()).filter(Boolean)}function Se(s){const t=Array.from(new Set((s||[]).map(l=>String(l||"").trim().toUpperCase()).filter(Boolean)));return t.sort(),t.join(",")}function V(s,t){return t?re(s).includes(String(t).toUpperCase()):!1}function P(s,t){const l=re(s);return l.push(String(t).toUpperCase()),Se(l)}function ie(s,t){const l=String(t||"").toUpperCase(),n=re(s).filter(u=>u!==l);return Se(n)}async function $(s){const t=Array.isArray(s)?s:[],l=200;for(let n=0;n<t.length;n+=l)await ne(i,t.slice(n,n+l))}async function He(s,t,l){const n=String(t||"").toUpperCase().trim();if(n){k(!0);try{const u=l?P(s.rolesCsv,n):ie(s.rolesCsv,n);await ne(i,[{permType:String(s.permType||"").toUpperCase(),permKey:String(s.permKey||"").toUpperCase(),rolesCsv:u,enabled:!!s.enabled}]),await I()}catch(u){h("admin_perm_quick_toggle",g(u,"Failed to update permission"))}finally{k(!1)}}}async function Je(){k(!0);try{await ke(i,{roleCode:"MIS",roleName:"MIS",status:"ACTIVE"}),await A();const s=Array.isArray(S)?S:[],t=[];for(const l of s)V(l.rolesCsv,"MIS")&&t.push({permType:String(l.permType||"").toUpperCase(),permKey:String(l.permKey||"").toUpperCase(),rolesCsv:ie(l.rolesCsv,"MIS"),enabled:!!l.enabled});t.length&&await $(t),await $([{permType:"UI",permKey:"PORTAL_EA_TECH",rolesCsv:P("","MIS"),enabled:!0},{permType:"UI",permKey:"SECTION_EXCEL_MARKS",rolesCsv:P("","MIS"),enabled:!0},{permType:"ACTION",permKey:"TECH_PENDING_LIST",rolesCsv:P("","MIS"),enabled:!0},{permType:"ACTION",permKey:"ADMIN_EXCEL_MARKS_SUBMIT",rolesCsv:P("","MIS"),enabled:!0}]),await I(),m.success("MIS preset applied (Excel only)")}catch(s){h("admin_perm_preset_mis",g(s,"Failed to apply MIS preset"))}finally{k(!1)}}async function Ge(s){const t=String(s||"").toUpperCase().trim();if(t){k(!0);try{const u=(Array.isArray(S)?S:[]).filter(o=>String(o.permType||"").toUpperCase()==="UI"&&String(o.permKey||"").toUpperCase().startsWith("PORTAL_")).filter(o=>!V(o.rolesCsv,t)).map(o=>({permType:"UI",permKey:String(o.permKey||"").toUpperCase(),rolesCsv:P(o.rolesCsv,t),enabled:!!o.enabled}));u.length&&await $(u),await I(),m.success("Portals granted")}catch(l){h("admin_perm_grant_portals",g(l,"Failed to grant portals"))}finally{k(!1)}}}async function qe(s){const t=String(s||"").toUpperCase().trim();if(t){k(!0);try{const u=(Array.isArray(S)?S:[]).filter(o=>String(o.permType||"").toUpperCase()==="UI"&&String(o.permKey||"").toUpperCase().startsWith("PORTAL_")).filter(o=>V(o.rolesCsv,t)).map(o=>({permType:"UI",permKey:String(o.permKey||"").toUpperCase(),rolesCsv:ie(o.rolesCsv,t),enabled:!!o.enabled}));u.length&&await $(u),await I(),m.success("Portals revoked")}catch(l){h("admin_perm_revoke_portals",g(l,"Failed to revoke portals"))}finally{k(!1)}}}async function Xe(s){if(s.preventDefault(),!(!j.email||!j.role))try{await ps(i,j),m.success("User saved"),N({email:"",fullName:"",role:"EA",active:!0}),await ee()}catch(t){h("admin_user_save",g(t,"Failed to save user"))}}async function Qe(s){s.preventDefault();const t=String(w.roleCode||"").toUpperCase().trim();if(t)try{await ke(i,{roleCode:t,roleName:String(w.roleName||"").trim()||t,status:String(w.status||"ACTIVE").toUpperCase().trim()}),m.success("Role saved"),M({roleCode:"",roleName:"",status:"ACTIVE"}),await A()}catch(l){h("admin_role_save",g(l,"Failed to save role"))}}async function ze(s){s.preventDefault();const t=String(C.permType||"").toUpperCase().trim(),l=String(C.permKey||"").toUpperCase().trim(),n=String(C.rolesCsv||"").trim(),u=!!C.enabled;if(!(!t||!l)){if(t!=="ACTION"&&t!=="UI"){m.error("permType must be ACTION or UI");return}try{await ne(i,[{permType:t,permKey:l,rolesCsv:n,enabled:u}]),m.success("Permission saved"),R({permType:"UI",permKey:"",rolesCsv:"",enabled:!0}),await I()}catch(o){h("admin_permission_save",g(o,"Failed to save permission"))}}}async function Ye(s){if(s.preventDefault(),!(!y.jobRole||!y.jobTitle))try{await ms(i,y),m.success("Template saved"),b({templateId:null,jobRole:"",jobTitle:"",jd:"",responsibilities:"",skills:"",shift:"",payScale:"",perks:"",notes:"",active:!0}),await se()}catch(t){h("admin_template_save",g(t,"Failed to save template"))}}async function Ze(s){s.preventDefault();const t=Number(he),l=Number(ye);if(!Number.isFinite(t)||t<0||t>10){m.error("Passing marks must be 0–10");return}if(!Number.isFinite(l)||l<0||l>10){m.error("NotPick threshold must be 0–10");return}try{await hs(i,[{key:"PASSING_MARKS",value:t,type:"number",scope:"GLOBAL"},{key:"NOT_PICK_THRESHOLD",value:l,type:"number",scope:"GLOBAL"},{key:"INTERVIEW_MESSAGE_TEMPLATE",value:String(be||""),type:"string",scope:"GLOBAL"}]),m.success("Settings saved"),await te()}catch(n){h("admin_settings_save",g(n,"Failed to save settings"))}}async function es(){me(!0);try{const s=await us(i);m.success(`Final Hold no-show auto reject done (rejected: ${s.rejected??0})`)}catch(s){h("admin_final_noshow",g(s,"Failed to run Final Hold no-show auto reject"))}finally{me(!1)}}return e.jsxs(ds,{children:[e.jsxs("div",{className:"card",children:[_==="ADMIN"?e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:[e.jsx("button",{className:"button",type:"button",onClick:()=>d("/dashboard"),children:"Open Dashboard"}),e.jsx("button",{className:"button",type:"button",onClick:()=>d("/hr/review"),children:"Open HR Portal"}),e.jsx("button",{className:"button",type:"button",onClick:()=>d("/owner"),children:"Open Owner Portal"}),e.jsx("button",{className:"button",type:"button",onClick:()=>d("/ea/tech"),children:"Open EA Tech"})]}):null,e.jsxs("div",{className:"row",children:[e.jsx("h2",{style:{margin:0},children:"Admin"}),e.jsx("div",{className:"spacer"}),e.jsx("button",{className:"button",onClick:()=>d("/dashboard"),children:"Back"})]}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"tabs",children:U.map(s=>e.jsx("button",{className:["tab",c===s.key?"active":""].join(" "),onClick:()=>W(s.key),type:"button",children:s.label},s.key))})]}),e.jsx("div",{style:{height:12}}),c==="users"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"User Management"}),e.jsx("form",{onSubmit:Xe,className:"card",style:{background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Email",value:j.email,onChange:s=>N(t=>({...t,email:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:260}}),e.jsx("input",{placeholder:"Full name",value:j.fullName,onChange:s=>N(t=>({...t,fullName:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:220}}),e.jsx("select",{value:j.role,onChange:s=>N(t=>({...t,role:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:le.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsxs("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:j.active,onChange:s=>N(t=>({...t,active:s.target.checked}))}),"Active"]}),e.jsx("button",{className:"button primary",type:"submit",disabled:!j.email||!j.role,children:"Save"}),e.jsx("button",{className:"button",type:"button",onClick:()=>N({email:"",fullName:"",role:"EA",active:!0}),children:"Clear"})]})}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"small",children:v?"Loading…":`${F.length} users`}),e.jsx("div",{style:{overflowX:"auto",marginTop:8},children:e.jsxs("table",{width:"100%",cellPadding:"8",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#fafafa"},children:[e.jsx("th",{align:"left",children:"Email"}),e.jsx("th",{align:"left",children:"Name"}),e.jsx("th",{align:"left",children:"Role"}),e.jsx("th",{align:"left",children:"Status"}),e.jsx("th",{align:"left",children:"Last Login"}),e.jsx("th",{align:"left",children:"Action"})]})}),e.jsx("tbody",{children:F.map(s=>e.jsxs("tr",{style:{borderTop:"1px solid #eee"},children:[e.jsx("td",{children:s.email}),e.jsx("td",{children:s.fullName}),e.jsx("td",{children:s.role}),e.jsx("td",{children:s.status}),e.jsx("td",{className:"small",children:s.lastLoginAt?String(s.lastLoginAt):"-"}),e.jsx("td",{children:e.jsx("button",{className:"button",type:"button",onClick:()=>N({email:s.email,fullName:s.fullName,role:s.role,active:String(s.status).toUpperCase()==="ACTIVE"}),children:"Edit"})})]},s.email))})]})})]}):null,c==="roles"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"Roles"}),e.jsx("div",{className:"small",style:{marginBottom:10},children:"Create/update roles. New roles can log in when status is ACTIVE."}),e.jsx("form",{onSubmit:Qe,className:"card",style:{background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"roleCode (e.g., MIS)",value:w.roleCode,onChange:s=>M(t=>({...t,roleCode:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:220}}),e.jsx("input",{placeholder:"roleName (display)",value:w.roleName,onChange:s=>M(t=>({...t,roleName:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:240}}),e.jsxs("select",{value:w.status,onChange:s=>M(t=>({...t,status:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"ACTIVE",children:"ACTIVE"}),e.jsx("option",{value:"INACTIVE",children:"INACTIVE"})]}),e.jsx("button",{className:"button primary",type:"submit",disabled:!w.roleCode,children:"Save"}),e.jsx("button",{className:"button",type:"button",onClick:()=>M({roleCode:"",roleName:"",status:"ACTIVE"}),children:"Clear"}),e.jsx("button",{className:"button",type:"button",onClick:A,disabled:f,children:f?"Loading…":"Refresh"})]})}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"small",children:f?"Loading…":`${(r||[]).length} roles`}),e.jsx("div",{style:{overflowX:"auto",marginTop:8},children:e.jsxs("table",{width:"100%",cellPadding:"8",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#fafafa"},children:[e.jsx("th",{align:"left",children:"roleCode"}),e.jsx("th",{align:"left",children:"roleName"}),e.jsx("th",{align:"left",children:"status"}),e.jsx("th",{align:"left",children:"updatedAt"}),e.jsx("th",{align:"left",children:"updatedBy"}),e.jsx("th",{align:"left",children:"Action"})]})}),e.jsx("tbody",{children:(r||[]).map(s=>e.jsxs("tr",{style:{borderTop:"1px solid #eee"},children:[e.jsx("td",{children:s.roleCode}),e.jsx("td",{children:s.roleName||"-"}),e.jsx("td",{children:s.status}),e.jsx("td",{className:"small",children:s.updatedAt?String(s.updatedAt):"-"}),e.jsx("td",{className:"small",children:s.updatedBy||"-"}),e.jsx("td",{children:e.jsx("button",{className:"button",type:"button",onClick:()=>M({roleCode:s.roleCode,roleName:s.roleName||"",status:String(s.status||"ACTIVE").toUpperCase()}),children:"Edit"})})]},s.roleCode))})]})})]}):null,c==="trainings"?e.jsx(bs,{token:i}):null,c==="permissions"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"Permissions"}),e.jsx("div",{className:"small",style:{marginBottom:10},children:"Manage ACTION/UI permissions (comma-separated roles). UI keys prefixed with PORTAL_ control portal access."}),e.jsxs("div",{className:"card",style:{background:"#fafafa",marginBottom:12},children:[e.jsxs("div",{className:"row",style:{flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("select",{value:T,onChange:s=>_e(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"",children:"Quick assign role (optional)"}),le.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("button",{className:"button",type:"button",disabled:!T||D,onClick:()=>Ge(T),children:"Grant all portals"}),e.jsx("button",{className:"button",type:"button",disabled:!T||D,onClick:()=>qe(T),children:"Revoke all portals"}),e.jsx("div",{className:"spacer"}),e.jsx("button",{className:"button",type:"button",disabled:D,onClick:Je,children:"One-click: MIS (Excel only)"})]}),e.jsx("div",{className:"small",style:{marginTop:6,color:"#666"},children:"With a role selected, click the checkbox in the table to grant/revoke that permission for the role (auto-saves)."})]}),e.jsx("form",{onSubmit:ze,className:"card",style:{background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsxs("select",{value:C.permType,onChange:s=>R(t=>({...t,permType:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"UI",children:"UI"}),e.jsx("option",{value:"ACTION",children:"ACTION"})]}),e.jsx("input",{placeholder:"permKey (e.g., PORTAL_HR_REVIEW)",value:C.permKey,onChange:s=>R(t=>({...t,permKey:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:320}}),e.jsx("input",{placeholder:"rolesCsv (e.g., ADMIN,HR)",value:C.rolesCsv,onChange:s=>R(t=>({...t,rolesCsv:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:320}}),e.jsxs("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:!!C.enabled,onChange:s=>R(t=>({...t,enabled:s.target.checked}))}),"Enabled"]}),e.jsx("button",{className:"button primary",type:"submit",disabled:!C.permType||!C.permKey,children:"Save"}),e.jsx("button",{className:"button",type:"button",onClick:()=>R({permType:"UI",permKey:"",rolesCsv:"",enabled:!0}),children:"Clear"}),e.jsx("button",{className:"button",type:"button",onClick:I,disabled:H,children:H?"Loading…":"Refresh"})]})}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"card",style:{background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsxs("select",{value:J,onChange:s=>Re(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"UI",children:"UI"}),e.jsx("option",{value:"ACTION",children:"ACTION"})]}),e.jsx("input",{placeholder:"Search (optional)",value:G,onChange:s=>Ae(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:260}}),e.jsx("div",{className:"spacer"}),e.jsx("div",{className:"small",children:H?"Loading…":`${Ne.length} rules`})]})}),e.jsx("div",{style:{overflowX:"auto",marginTop:8},children:e.jsxs("table",{width:"100%",cellPadding:"8",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#fafafa"},children:[e.jsx("th",{align:"left",children:"Type"}),e.jsx("th",{align:"left",children:"Key"}),e.jsx("th",{align:"left",children:"Enabled"}),e.jsx("th",{align:"left",children:"Roles"}),e.jsx("th",{align:"left",children:"updatedAt"}),e.jsx("th",{align:"left",children:"updatedBy"}),e.jsx("th",{align:"left",children:"Action"})]})}),e.jsx("tbody",{children:Ne.map(s=>e.jsxs("tr",{style:{borderTop:"1px solid #eee"},children:[e.jsx("td",{children:s.permType}),e.jsx("td",{className:"small",children:s.permKey}),e.jsx("td",{children:s.enabled?"TRUE":"FALSE"}),e.jsx("td",{className:"small",children:s.rolesCsv||"-"}),e.jsx("td",{className:"small",children:s.updatedAt?String(s.updatedAt):"-"}),e.jsx("td",{className:"small",children:s.updatedBy||"-"}),e.jsxs("td",{children:[T?e.jsxs("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:V(s.rolesCsv,T),disabled:D,onChange:t=>He(s,T,t.target.checked)}),"Allow"]}):null,e.jsx("button",{className:"button",type:"button",onClick:()=>R({permType:String(s.permType||"UI").toUpperCase(),permKey:s.permKey,rolesCsv:s.rolesCsv||"",enabled:!!s.enabled}),children:"Edit"})]})]},`${s.permType}:${s.permKey}`))})]})}),e.jsx("div",{style:{height:8}}),e.jsx("div",{className:"small",style:{color:"#666"},children:"Tip: rolesCsv uses role codes (e.g., ADMIN,HR,MIS). To disable a permission for everyone, uncheck Enabled."})]}):null,c==="settings"?e.jsxs("div",{className:"card",style:{marginTop:12},children:[e.jsx("h3",{style:{marginTop:0},children:"Manual Actions"}),e.jsx("div",{className:"small",style:{marginBottom:10},children:"Run system actions manually (admin-only)."}),e.jsx("div",{className:"row",style:{flexWrap:"wrap",gap:10,alignItems:"center"},children:e.jsx("button",{className:"button",type:"button",onClick:es,disabled:ue,children:ue?"Running…":"Run Final Hold No-show Auto Reject"})})]}):null,c==="templates"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"Job Templates"}),e.jsxs("form",{onSubmit:Ye,className:"card",style:{background:"#fafafa"},children:[e.jsx("div",{className:"small",style:{marginBottom:8},children:"Create/update templates by Job Role (CRM, MIS, Jr Accountant, …)"}),e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Job Role (key)",value:y.jobRole,onChange:s=>b(t=>({...t,jobRole:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:220}}),e.jsx("input",{placeholder:"Job Title",value:y.jobTitle,onChange:s=>b(t=>({...t,jobTitle:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:240}}),e.jsxs("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:y.active,onChange:s=>b(t=>({...t,active:s.target.checked}))}),"Active"]}),e.jsx("button",{className:"button primary",type:"submit",disabled:!y.jobRole||!y.jobTitle,children:"Save"}),e.jsx("button",{className:"button",type:"button",onClick:()=>b({templateId:null,jobRole:"",jobTitle:"",jd:"",responsibilities:"",skills:"",shift:"",payScale:"",perks:"",notes:"",active:!0}),children:"New"})]}),e.jsx("div",{style:{height:10}}),e.jsx("textarea",{placeholder:"JD",value:y.jd,onChange:s=>b(t=>({...t,jd:s.target.value})),rows:4,style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #d0d5dd"}}),e.jsx("div",{style:{height:8}}),e.jsx("textarea",{placeholder:"Responsibilities",value:y.responsibilities,onChange:s=>b(t=>({...t,responsibilities:s.target.value})),rows:3,style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #d0d5dd"}}),e.jsx("div",{style:{height:8}}),e.jsx("textarea",{placeholder:"Skills",value:y.skills,onChange:s=>b(t=>({...t,skills:s.target.value})),rows:3,style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #d0d5dd"}}),e.jsx("div",{style:{height:8}}),e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Shift",value:y.shift,onChange:s=>b(t=>({...t,shift:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180}}),e.jsx("input",{placeholder:"Pay scale",value:y.payScale,onChange:s=>b(t=>({...t,payScale:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180}}),e.jsx("input",{placeholder:"Perks",value:y.perks,onChange:s=>b(t=>({...t,perks:s.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180}})]}),e.jsx("div",{style:{height:8}}),e.jsx("textarea",{placeholder:"Notes",value:y.notes,onChange:s=>b(t=>({...t,notes:s.target.value})),rows:2,style:{width:"100%",padding:8,borderRadius:8,border:"1px solid #d0d5dd"}})]}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"small",children:Ee?"Loading…":`${de.length} templates`}),e.jsx("div",{style:{overflowX:"auto",marginTop:8},children:e.jsxs("table",{width:"100%",cellPadding:"8",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#fafafa"},children:[e.jsx("th",{align:"left",children:"Job Role"}),e.jsx("th",{align:"left",children:"Job Title"}),e.jsx("th",{align:"left",children:"Status"}),e.jsx("th",{align:"left",children:"Action"})]})}),e.jsx("tbody",{children:de.map(s=>e.jsxs("tr",{style:{borderTop:"1px solid #eee"},children:[e.jsx("td",{children:s.jobRole}),e.jsx("td",{children:s.jobTitle}),e.jsx("td",{children:s.status}),e.jsx("td",{children:e.jsx("button",{className:"button",type:"button",onClick:()=>b({templateId:s.templateId,jobRole:s.jobRole,jobTitle:s.jobTitle,jd:s.jd,responsibilities:s.responsibilities,skills:s.skills,shift:s.shift,payScale:s.payScale,perks:s.perks,notes:s.notes,active:String(s.status).toUpperCase()==="ACTIVE"}),children:"Edit"})})]},s.templateId))})]})})]}):null,c==="settings"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"Settings"}),e.jsx("div",{className:"small",children:"Global thresholds (server-enforced later in pipeline)"}),e.jsx("form",{onSubmit:Ze,className:"card",style:{marginTop:12,background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["Passing marks (default 6/10)",e.jsx("input",{type:"number",value:he,onChange:s=>ge(s.target.value),min:0,max:10,step:1,style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",width:180}})]}),e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["NotPick threshold (default 3)",e.jsx("input",{type:"number",value:ye,onChange:s=>xe(s.target.value),min:0,max:10,step:1,style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",width:180}})]}),e.jsxs("label",{className:"small",style:{display:"grid",gap:6,minWidth:420,flex:"1 1 420px"},children:["Interview Message Template",e.jsxs("span",{style:{color:"#666"},children:["Use placeholders: ","{{Candidate Name}}",", ","{{Job Title}}",", ","{{Date}}",", ","{{Time}}"]}),e.jsx("textarea",{rows:6,value:be,onChange:s=>je(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},placeholder:"Paste the exact message template here"})]}),e.jsx("div",{className:"spacer"}),e.jsx("button",{className:"button primary",type:"submit",disabled:Le,children:"Save"})]})})]}):null,c==="logs"?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:"Logs Viewer"}),e.jsx("div",{className:"card",style:{background:"#fafafa"},children:e.jsxs("div",{className:"row",style:{flexWrap:"wrap"},children:[e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["Type",e.jsxs("select",{value:O,onChange:s=>Me(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"AUDIT",children:"Audit"}),e.jsx("option",{value:"REJECTION",children:"Rejection"}),e.jsx("option",{value:"HOLD",children:"Hold"}),e.jsx("option",{value:"JOIN",children:"Join"})]})]}),e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["From",e.jsx("input",{type:"date",value:K,onChange:s=>Pe(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"}})]}),e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["To",e.jsx("input",{type:"date",value:B,onChange:s=>We(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"}})]}),e.jsx("input",{placeholder:"stageTag (optional)",value:q,onChange:s=>Fe(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180,marginTop:18}}),e.jsxs("select",{value:X,onChange:s=>Oe(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",marginTop:18},children:[e.jsx("option",{value:"",children:"Actor role (any)"}),le.map(s=>e.jsx("option",{value:s,children:s},s)),e.jsx("option",{value:"SYSTEM",children:"SYSTEM"})]}),O==="AUDIT"?e.jsxs(e.Fragment,{children:[e.jsx("input",{placeholder:"entityType (AUDIT)",value:Q,onChange:s=>De(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:160,marginTop:18}}),e.jsx("input",{placeholder:"entityId (AUDIT)",value:z,onChange:s=>Ke(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180,marginTop:18}})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{placeholder:"candidateId",value:Y,onChange:s=>Be(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180,marginTop:18}}),e.jsx("input",{placeholder:"requirementId",value:Z,onChange:s=>Ve(s.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd",minWidth:180,marginTop:18}})]}),e.jsx("button",{className:"button primary",type:"button",onClick:ae,disabled:ve,style:{marginTop:18},children:"Refresh"})]})}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"small",children:ve?"Loading…":`${Ce.length} rows (latest first)`}),e.jsx("div",{style:{overflowX:"auto",marginTop:8},children:e.jsxs("table",{width:"100%",cellPadding:"8",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#fafafa"},children:[e.jsx("th",{align:"left",children:"At"}),e.jsx("th",{align:"left",children:"stageTag"}),e.jsx("th",{align:"left",children:"actorRole"}),e.jsx("th",{align:"left",children:"actorUserId"}),e.jsx("th",{align:"left",children:"remark"}),e.jsx("th",{align:"left",children:"ref"})]})}),e.jsx("tbody",{children:Ce.map((s,t)=>e.jsxs("tr",{style:{borderTop:"1px solid #eee"},children:[e.jsx("td",{className:"small",children:s.at?String(s.at):"-"}),e.jsx("td",{className:"small",children:s.stageTag||"-"}),e.jsx("td",{className:"small",children:s.actorRole||"-"}),e.jsx("td",{className:"small",children:s.actorUserId||"-"}),e.jsx("td",{className:"small",children:s.remark||"-"}),e.jsx("td",{className:"small",children:O==="AUDIT"?`${s.entityType||""}:${s.entityId||""}`:`${s.candidateId||""}:${s.requirementId||""}`})]},String(s.logId||t)))})]})})]}):null]})}export{fs as AdminPage};
